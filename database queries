CREATE DATABASE mydb;

USE mydb;

mysql -h host -u user -p mydb;

CREATE TABLE customers (
id INT(24) NOT NULL PRIMARY KEY,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
company VARCHAR(30) DEFAULT NULL,
department VARCHAR(60) DEFAULT NULL,
address VARCHAR(60) DEFAULT NULL,
postalCode VARCHAR(60) DEFAULT NULL,
city VARCHAR(60) DEFAULT NULL,
state INT(10) DEFAULT NULL
);

CREATE TABLE users (
id INT(24) NOT NULL PRIMARY KEY,
customerId INT(24) DEFAULT NULL,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
username VARCHAR(30) DEFAULT NULL,
password VARCHAR(60),
isadmin INT(5) DEFAULT NULL,
salutation INT(5) DEFAULT NULL,
title INT(5) DEFAULT NULL,
name VARCHAR(30) DEFAULT NULL,
surname VARCHAR(30) DEFAULT NULL,
position VARCHAR(30) DEFAULT NULL,
phone VARCHAR(30) DEFAULT NULL,
email VARCHAR(30) DEFAULT NULL,
FOREIGN KEY (customerId) REFERENCES customers(id)
);




CREATE TABLE holidays (
id INT(24) NOT NULL PRIMARY KEY,
customerId INT(24) DEFAULT NULL,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
name VARCHAR(30),
state INT(10) DEFAULT NULL,
date DATETIME DEFAULT NULL,
FOREIGN KEY (customerId) REFERENCES customers(id)
);


CREATE TABLE departments (
customerId INT(24) DEFAULT NULL,
id INT(24) NOT NULL PRIMARY KEY,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
name VARCHAR(30),
startRecording DATETIME DEFAULT NULL,
endRecording DATETIME DEFAULT NULL,
FOREIGN KEY (customerId) REFERENCES customers(id)
);


CREATE TABLE userDepartmentRels (
id INT(24) NOT NULL PRIMARY KEY,
customerId INT(24) DEFAULT NULL,
userId INT(24) NOT NULL,
departmentId INT(24) NOT NULL,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
FOREIGN KEY (userId) REFERENCES users(id),
FOREIGN KEY (departmentId) REFERENCES departments(id),
FOREIGN KEY (customerId) REFERENCES customers(id)
);

CREATE TABLE services (
id INT(24) NOT NULL PRIMARY KEY,
customerId INT(24) DEFAULT NULL,
departmentId INT(24) NOT NULL,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
FOREIGN KEY (departmentId) REFERENCES departments(id),
name VARCHAR(30),
start DATETIME DEFAULT NULL,
end DATETIME DEFAULT NULL,
staff INT(5) DEFAULT NULL,
holiday INT(5) DEFAULT NULL,
monday INT(5) DEFAULT NULL,
tuesday INT(5) DEFAULT NULL,
wednesday INT(5) DEFAULT NULL,
thursday INT(5) DEFAULT NULL,
friday INT(5) DEFAULT NULL,
saturday INT(5) DEFAULT NULL,
sunday INT(5) DEFAULT NULL,
FOREIGN KEY (customerId) REFERENCES customers(id)
);


CREATE TABLE dutyTypes (
id INT(24) NOT NULL PRIMARY KEY,
customerId INT(24) DEFAULT NULL,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
name VARCHAR(30) DEFAULT NULL,
FOREIGN KEY (customerId) REFERENCES customers(id)
);


CREATE TABLE dutyTypeServiceRels (
id INT(24) NOT NULL PRIMARY KEY,
customerId INT(24) DEFAULT NULL,
dutyTypeId INT(24) NOT NULL,
serviceId INT(24) NOT NULL,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
FOREIGN KEY (dutyTypeId) REFERENCES dutyTypes(id),
FOREIGN KEY (serviceId) REFERENCES services(id),
FOREIGN KEY (customerId) REFERENCES customers(id)
);


CREATE TABLE performedServices (
customerId INT(24) DEFAULT NULL,
id INT(24) NOT NULL PRIMARY KEY,
userId INT(24) NOT NULL,
serviceId INT(24) NOT NULL,
dutyTypeId INT(24) NOT NULL,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
actualStart DATETIME DEFAULT NULL,
actualEnd DATETIME DEFAULT NULL,
FOREIGN KEY (userId) REFERENCES users(id),
FOREIGN KEY (dutyTypeId) REFERENCES dutyTypes(id),
FOREIGN KEY (serviceId) REFERENCES services(id),
secsBefore INT(24) DEFAULT NULL,
secsDuring INT(24) DEFAULT NULL,
secsAfter INT(24) DEFAULT NULL,
percToBefore DATETIME DEFAULT NULL,
percToDuring DATETIME DEFAULT NULL,
percToAfter DATETIME DEFAULT NULL,
FOREIGN KEY (customerId) REFERENCES customers(id)
);

CREATE TABLE schedules (
id INT(24) NOT NULL PRIMARY KEY,
customerId INT(24) DEFAULT NULL,
serviceId INT(24) NOT NULL,
datedeactivated DATETIME DEFAULT NULL,
lastModified DATETIME ON UPDATE CURRENT_TIMESTAMP,
FOREIGN KEY (serviceId) REFERENCES services(id),
start DATETIME DEFAULT NULL,
end DATETIME DEFAULT NULL,
staff INT(5) DEFAULT NULL,
date DATETIME DEFAULT NULL,
FOREIGN KEY (customerId) REFERENCES customers(id)
);
